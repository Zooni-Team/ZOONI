@{
    var tema = Context.Session.GetString("Tema") ?? "claro";
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>@ViewData["Title"] - Zooni</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/global.css" />

    <style>
        :root {
            --verde: #39b77c;
            --marron: #3c2a1b;
            --amarillo: #FFD85A;
            --fondo-claro: #f9f9f8;
            --fondo-oscuro: #121212;
            --texto-claro: #3c2a1b;
            --texto-oscuro: #ffffff;
        }

        /* Header con icono del menú */
        .layout-header {
            position: fixed;
            top: 15px;
            left: 20px;
            z-index: 100;
        }

        .menu-icon {
            width: 38px;
            height: 38px;
            display: block;
            cursor: pointer;
            transition: transform .25s ease, filter .3s ease;
            filter: brightness(0);
        }
        body.tema-oscuro .menu-icon {
            filter: brightness(0) invert(1);
        }
        .menu-icon:hover { transform: scale(1.1); }

        /* Menú lateral */
        .menu-lateral {
            position: fixed;
            top: 0;
            left: 0; 
            transform: translateX(-100%);
            width: 240px;
            height: 100%;
            backdrop-filter: blur(12px);
            box-shadow: 4px 0 12px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            padding: 2.5rem 1.2rem;
            gap: 1rem;
            transition: transform 0.35s ease, background .4s ease, color .4s ease;
            z-index: 9999;
            border-radius: 0 !important;
        }
        body.tema-claro .menu-lateral {
            background: rgba(255, 255, 255, 0.97);
        }
        body.tema-oscuro .menu-lateral {
            background: rgba(30, 30, 30, 0.97);
            box-shadow: 4px 0 12px rgba(0, 0, 0, 0.5);
        }
        .menu-lateral.abierto { transform: translateX(0); }
        
        .menu-lateral a {
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 0.6rem 0.8rem;
            border-radius: 12px;
            transition: all .25s ease;
            color: inherit;
        }
        body.tema-claro .menu-lateral a {
            color: var(--marron);
        }
        body.tema-oscuro .menu-lateral a {
            color: #ffffff;
        }
        body.tema-claro .menu-lateral a:hover {
            background: var(--amarillo);
            color: #3c2a00;
        }
        body.tema-oscuro .menu-lateral a:hover {
            background: var(--verde);
            color: #ffffff;
        }

        .cerrar-menu {
            align-self: flex-end;
            font-size: 1.6rem;
            cursor: pointer;
            margin-bottom: 1.5rem;
            transition: transform 0.2s ease;
            color: inherit;
        }
        body.tema-claro .cerrar-menu {
            color: var(--marron);
        }
        body.tema-oscuro .cerrar-menu {
            color: #ffffff;
        }
        .cerrar-menu:hover { transform: scale(1.2); }

        /* Overlay */
        .menu-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.25);
            opacity: 0; 
            pointer-events: none;
            transition: opacity .3s ease;
            z-index: 9998;
        }
        .menu-overlay.activo { 
            opacity: 1; 
            pointer-events: auto; 
        }
    </style>

    @RenderSection("Styles", required: false)
</head>

<body class="tema-@(tema)">
    <!-- Header con icono del menú -->
    <div class="layout-header">
        <img src="/img/icons/hamburger.png" alt="Menú" class="menu-icon" id="abrirMenuLayout" />
    </div>

    <!-- Menú lateral -->
    <div class="menu-lateral" id="menuLateralLayout">
        <div class="cerrar-menu" id="cerrarMenuLayout">✖</div>
        <a href="/Home/Index">🏠 Inicio</a>
        <a href="/Home/Comunidad">👥 Comunidad</a>
        <a href="/Home/Planificador">📅 Planificador de Servicios</a>
        <a href="/Marketplace">🛒 Marketplace</a>
        <a href="/Home/FichaMedica">💉 Ficha médica</a>
        <a href="/Home/Calendario">📅 Calendario</a>
        <a href="/Chat/ChatZooni">💬 ChatBot</a>
        <a href="/Home/Closet">👕 Closet</a>
        <a href="/Home/Perfil">👤 Perfil</a>
        <a href="/Home/Configuracion">⚙️ Configuración</a>
        <a href="/Auth/Logout" style="color:red;">🚪 Cerrar sesión</a>
    </div>

    <!-- Overlay del menú -->
    <div class="menu-overlay" id="menuOverlayLayout"></div>

    <!-- Contenido principal -->
    <main role="main">
        @RenderBody()
    </main>

    @RenderSection("Scripts", required: false)
    
    <script>
    // ===== Menú lateral del Layout =====
    (function() {
        const menu = document.getElementById("menuLateralLayout");
        const overlay = document.getElementById("menuOverlayLayout");
        const abrir = document.getElementById("abrirMenuLayout");
        const cerrar = document.getElementById("cerrarMenuLayout");

        function abrirMenu() {
            menu.classList.add("abierto");
            overlay.classList.add("activo");
        }

        function cerrarMenu() {
            menu.classList.remove("abierto");
            overlay.classList.remove("activo");
        }

        if (abrir) abrir.addEventListener("click", abrirMenu);
        if (cerrar) cerrar.addEventListener("click", cerrarMenu);
        if (overlay) overlay.addEventListener("click", cerrarMenu);

        // Cerrar con Escape
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") cerrarMenu();
        });
    })();

    // Transición de tema
    function activarTransicionTema() {
        const overlay = document.createElement('div');
        overlay.classList.add('theme-transition');
        document.body.appendChild(overlay);
        void overlay.offsetWidth;
        overlay.classList.add('activo');
        setTimeout(() => {
            overlay.classList.remove('activo');
            setTimeout(() => overlay.remove(), 400);
        }, 500);
    }
    </script>
</body>
</html>
