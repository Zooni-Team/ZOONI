@using Zooni.Models
@{
    ViewData["Title"] = "Configuraci√≥n de Mascotas üê∂";
    Layout = "_Layout";
    var tema = ViewBag.Tema ?? "claro";
    var mascotasActivas = ViewBag.MascotasActivas as List<Mascota> ?? new();
    var mascotasArchivadas = ViewBag.MascotasArchivadas as List<Mascota> ?? new();
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"]</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: @(tema == "oscuro" ? "#1f1f1f" : "#fafafa");
            color: @(tema == "oscuro" ? "#f2f2f2" : "#333");
            margin: 0;
            padding: 0;
        }
        .config-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 20px;
            color: @(tema == "oscuro" ? "#3ac37d" : "#2b8558");
        }
        .mascotas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .card {
            background: @(tema == "oscuro" ? "#2a2a2a" : "#fff");
            border-radius: 18px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 18px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .card img {
            width: 120px;
            height: 120px;
            border-radius: 100%;
            object-fit: cover;
            margin-bottom: 10px;
            border: 3px solid #3ac37d;
        }
        .card h3 {
            margin: 0;
            font-size: 1.3rem;
            color: @(tema == "oscuro" ? "#fff" : "#4b3b2b");
        }
        .card p {
            margin: 4px 0;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .acciones {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }
        .btn {
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn-editar {
            background-color: #ffd85a;
            color: #4b3b2b;
        }
        .btn-archivar {
            background-color: #f87171;
            color: #fff;
        }
        .btn-editar:hover { background-color: #ffc93c; }
        .btn-archivar:hover { background-color: #ef4444; }

        .seccion-titulo {
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 40px;
            margin-bottom: 10px;
            color: @(tema == "oscuro" ? "#ffd85a" : "#3ac37d");
        }

        .btn-agregar {
            display: block;
            margin: 20px auto;
            background-color: #3ac37d;
            color: white;
            font-weight: 600;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            transition: 0.3s ease;
        }
        .btn-agregar:hover { background-color: #2f9e64; transform: scale(1.03); }

        .mensaje-vacio {
            text-align: center;
            opacity: 0.7;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="config-container">
        <h1>Configuraci√≥n de Mascotas üêæ</h1>

        <a href="/Registro/NuevaMascota" class="btn-agregar">+ Agregar nueva mascota</a>

        <div class="seccion-titulo">Activas</div>
        @if (mascotasActivas.Count > 0)
        {
            <div class="mascotas-grid">
                @foreach (var m in mascotasActivas)
                {
                    <div class="card">
                        <img src="@(string.IsNullOrEmpty(m.Foto) ? "/img/mascotas/default.png" : m.Foto)" alt="@m.Nombre" />
                        <h3>@m.Nombre</h3>
                        <p>@m.Especie - @m.Raza</p>
                        <div class="acciones">
                            <form asp-action="EditarMascota" asp-controller="Home" method="get">
                                <input type="hidden" name="id" value="@m.Id_Mascota" />
                                <button type="submit" class="btn btn-editar">Editar</button>
                            </form>
                            <form asp-action="ArchivarMascota" asp-controller="Home" method="post">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@m.Id_Mascota" />
                                <button type="submit" class="btn btn-archivar">Archivar</button>
                            </form>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="mensaje-vacio">No ten√©s mascotas activas actualmente.</p>
        }

        <div class="seccion-titulo">Archivadas üóÉ</div>
        @if (mascotasArchivadas.Count > 0)
        {
            <div class="mascotas-grid">
                @foreach (var m in mascotasArchivadas)
                {
                    <div class="card" style="opacity:0.7;">
                        <img src="@(string.IsNullOrEmpty(m.Foto) ? "/img/mascotas/default.png" : m.Foto)" alt="@m.Nombre" />
                        <h3>@m.Nombre</h3>
                        <p>@m.Especie - @m.Raza</p>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="mensaje-vacio">No hay mascotas archivadas.</p>
        }
    </div>
</body>
</html>
